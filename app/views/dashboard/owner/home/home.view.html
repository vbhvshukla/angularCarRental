<div class="content" ng-init="vm.init()" ng-controller="OwnerHomeDashboardController as vm">
    <div class="container">
        <h2>Pending Bids</h2>
        <select ng-model="vm.filters.pendingType" ng-change="vm.applyFilters()">
            <option value="all">All</option>
            <option value="local">Local</option>
            <option value="outstation">Outstation</option>
        </select>
        
        <table id="pending-bids-table">
            <thead>
                <tr>
                    <th>Car Name</th>
                    <th>Bid Amount</th>
                    <th>Total Amount</th>
                    <th>User</th>
                    <th>From</th>
                    <th>To</th>
                    <th>Rental Type</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="bid in vm.getPaginatedData(vm.filteredPendingBids, vm.pagination.pendingBids)">
                    <td>{{bid.car.carName}} </td>
                    <td>{{bid.bidAmount}}</td>
                    <td>{{bid.bidBaseFare}}</td>
                    <td>{{bid.user.username}}</td>
                    <td>{{bid.fromTimestamp | date:'MM/dd/yyyy'}}</td>
                    <td>{{bid.toTimestamp | date:'MM/dd/yyyy'}}</td>
                    <td>{{bid.rentalType}}</td>
                    <td>
                        <button ng-click="vm.acceptBid(bid)">Accept</button>
                        <button ng-click="vm.rejectBid(bid)">Reject</button>
                    </td>
                </tr>
            </tbody>
        </table>
        
        <!-- Pending Bids Pagination -->
        <div class="pagination" ng-if="vm.shouldShowPagination('pendingBids')">
            <button ng-click="vm.previousPage('pendingBids')" 
                    ng-disabled="vm.pagination.pendingBids.currentPage === 1">
                Previous
            </button>
            <span>Page {{vm.pagination.pendingBids.currentPage}} of {{vm.getTotalPages('pendingBids')}}</span>
            <button ng-click="vm.nextPage('pendingBids')"
                    ng-disabled="vm.pagination.pendingBids.currentPage >= vm.getTotalPages('pendingBids')">
                Next
            </button>
        </div>
        <p id="no-pending-bids" class="hidden">No pending bids.</p>

        <!-- Active Bookings Section -->
        <h2>Active Bookings</h2>
        <select ng-model="vm.filters.bookingType" ng-change="vm.applyFilters()">
            <option value="all">All</option>
            <option value="local">Local</option>
            <option value="outstation">Outstation</option>
        </select>

        <table id="bookings-table">
            <thead>
                <tr>
                    <th>Car Name</th>
                    <th>Bid Price</th>
                    <th>Total Amount</th>
                    <th>User</th>
                    <th>From</th>
                    <th>To</th>
                    <th>Created At</th>
                    <th>Rental Type</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="booking in vm.getPaginatedData(vm.filteredBookings, vm.pagination.bookings)">
                    <td>{{booking.bid.car.carName}}</td>
                    <td>{{booking.bid.bidAmount}}</td>
                    <td>{{vm.getTotalAmount(booking)}}</td>
                    <td>{{booking.bid.user.username}}</td>
                    <td>{{booking.fromTimestamp | date:'MM/dd/yyyy'}}</td>
                    <td>{{booking.toTimestamp | date:'MM/dd/yyyy'}}</td>
                    <td>{{booking.createdAt | date:'MM/dd/yyyy'}}</td>
                    <td>{{booking.rentalType}}</td>
                    <td ng-if="!vm.isBookingOver(booking)">N/A</td>
                    <td ng-if="vm.isBookingOver(booking)">
                        <button >Add Additional(Km/Hr)</button>
                    </td>
                </tr>
            </tbody>
        </table>

        <div class="pagination" ng-if="vm.shouldShowPagination('bookings')">
            <button ng-click="vm.previousPage('bookings')" 
                    ng-disabled="vm.pagination.bookings.currentPage === 1">
                Previous
            </button>
            <span>Page {{vm.pagination.bookings.currentPage}} of {{vm.getTotalPages('bookings')}}</span>
            <button ng-click="vm.nextPage('bookings')"
                    ng-disabled="vm.pagination.bookings.currentPage >= vm.getTotalPages('bookings')}">
                Next
            </button>
        </div>
        <p id="no-bookings" class="hidden">No active bookings.</p>

        <h2>All Bids</h2>
        <select ng-model="vm.filters.bidStatus" ng-change="vm.applyFilters()">
            <option value="all">All</option>
            <option value="pending">Pending</option>
            <option value="accepted">Accepted</option>
            <option value="rejected">Rejected</option>
        </select>

        <table id="all-bids-table">
            <thead>
                <tr>
                    <th>Car Name</th>
                    <th>Bid Amount</th>
                    <th>Total Amount</th>
                    <th>User</th>
                    <th>From</th>
                    <th>To</th>
                    <th>Rental Type</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="bid in vm.getPaginatedData(vm.filteredAllBids, vm.pagination.allBids)">
                    <td>{{bid.car.carName}}</td>
                    <td>{{bid.bidBaseFare}}</td>
                    <td>{{bid.bidAmount}}</td>
                    <td>{{bid.user.username}}</td>
                    <td>{{bid.fromTimestamp | date:'MM/dd/yyyy'}}</td>
                    <td>{{bid.toTimestamp | date:'MM/dd/yyyy'}}</td>
                    <td>{{bid.rentalType}}</td>
                    <td>{{bid.status}}</td>
                </tr>
            </tbody>
        </table>

        <!-- All Bids Pagination -->
        <div class="pagination" ng-if="vm.shouldShowPagination('allBids')">
            <button ng-click="vm.previousPage('allBids')" 
                    ng-disabled="vm.pagination.allBids.currentPage === 1">
                Previous
            </button>
            <span>Page {{vm.pagination.allBids.currentPage}} of {{vm.getTotalPages('allBids')}}</span>
            <button ng-click="vm.nextPage('allBids')"
                    ng-disabled="vm.pagination.allBids.currentPage >= vm.getTotalPages('allBids')}">
                Next
            </button>
        </div>
        <p id="no-all-bids" class="hidden">No bids found.</p>

    </div>
</div>
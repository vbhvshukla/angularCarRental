<div class="panel panel-default">
    <div class="panel-body" style="padding: 20px;">
        <!-- Car Header -->
        <div class="row" style="margin-bottom: 20px;">
            <div class="col-xs-8">
                <h2 class="text-primary">{{$ctrl.car.carName}}</h2>
            </div>
            <div class="col-xs-4 text-right">
                <span class="label label-info">{{$ctrl.car.category.categoryName}}</span>
            </div>
        </div>

        <!-- Car Images Carousel -->
        <div class="row" style="margin-bottom: 24px;">
            <div class="col-xs-12">
                <div uib-carousel active="active" no-wrap="false" no-pause="true">
                    <div uib-slide ng-repeat="image in $ctrl.car.images track by $index" index="$index">
                        <img ng-src="{{image}}" alt="Car Image {{$index + 1}}" class="img-responsive center-block"
                            style="height: 200px; object-fit: contain; border-radius: 8px;">
                    </div>
                </div>
            </div>
        </div>

        <!-- Car Information -->
        <div class="row">
            <div class="col-xs-12">
                <div class="well" style="background-color: #ffffff; margin-bottom: 24px;">
                    <h3 class="text-primary">Car Details</h3>

                    <!-- Basic Info -->
                    <div class="row" style="margin: 20px 0;">
                        <div class="col-xs-12 col-sm-6">
                            <strong class="text-muted">Type:</strong> {{$ctrl.car.carType}}
                        </div>
                        <div class="col-xs-12 col-sm-6">
                            <strong class="text-muted">City:</strong> {{$ctrl.car.city}}
                        </div>
                    </div>

                    <!-- Owner Info -->
                    <div class="row" style="margin-bottom: 15px;">
                        <div class="col-xs-12">
                            <p><strong>Owner Name:</strong> {{$ctrl.car.owner.username}}</p>
                            <div class="rating">
                                <span style="color: #ffd700; letter-spacing: 2px;">★★★★★</span>
                                <strong style="margin-left: 8px;">{{$ctrl.car.owner.avgRating | number:1}}</strong>
                                <span class="text-muted" style="font-size: 14px;">({{$ctrl.car.owner.ratingCount}}
                                    ratings)</span>
                            </div>
                        </div>
                    </div>

                    <!-- Description -->
                    <div class="row" style="margin-bottom: 24px;">
                        <div class="col-xs-12">
                            <strong>Description:</strong>
                            <p class="text-muted">{{$ctrl.car.description}}</p>
                        </div>
                    </div>

                    <!-- Availability -->
                    <div class="row">
                        <div class="col-xs-12 col-sm-6" ng-if="$ctrl.car.isAvailableForLocal">
                            <div class="text-success" style="margin-bottom: 15px;">
                                <i class="fa fa-check"></i> Available for Local Rentals
                                <div class="dropdown" style="display: inline-block;">
                                    <button class="btn btn-link btn-xs dropdown-toggle"
                                        uib-popover-template="'localRatesTemplate.html'" popover-trigger="mouseenter"
                                        popover-placement="top">
                                        <i class="fa fa-info-circle"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-6" ng-if="$ctrl.car.isAvailableForOutstation">
                            <div class="text-success">
                                <i class="fa fa-check"></i> Available for Outstation Rentals
                                <div class="dropdown" style="display: inline-block;">
                                    <button class="btn btn-link btn-xs dropdown-toggle"
                                        uib-popover-template="'outstationRatesTemplate.html'"
                                        popover-trigger="mouseenter" popover-placement="top">
                                        <i class="fa fa-info-circle"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Local Rates Template -->
<script type="text/ng-template" id="localRatesTemplate.html">
    <div style="min-width: 280px;">
        <h4 class="text-primary" style="margin: 0 0 10px;">Local Rental Rates</h4>
        <table class="table table-condensed">
            <tr><td>Base Rate:</td><td>₹{{$ctrl.car.rentalOptions.local.pricePerHour}}/hour</td></tr>
            <tr><td>Distance Limit:</td><td>{{$ctrl.car.rentalOptions.local.maxKmPerHour}}km/hour</td></tr>
            <tr><td>Extra Hour Rate:</td><td>₹{{$ctrl.car.rentalOptions.local.extraHourlyRate}}/hour</td></tr>
            <tr><td>Extra KM Rate:</td><td>₹{{$ctrl.car.rentalOptions.local.extraKmRate}}/km</td></tr>
        </table>
    </div>
</script>

<!-- Outstation Rates Template -->
<script type="text/ng-template" id="outstationRatesTemplate.html">
    <div style="min-width: 280px;">
        <h4 class="text-primary" style="margin: 0 0 10px;">Outstation Rental Rates</h4>
        <table class="table table-condensed">
            <tr><td>Daily Rate:</td><td>₹{{$ctrl.car.rentalOptions.outstation.pricePerDay}}/day</td></tr>
            <tr><td>Per KM Rate:</td><td>₹{{$ctrl.car.rentalOptions.outstation.pricePerKm}}/km</td></tr>
            <tr><td>Daily KM Limit:</td><td>{{$ctrl.car.rentalOptions.outstation.maxKmLimitPerDay}}km</td></tr>
            <tr><td>Min. KM Charge:</td><td>{{$ctrl.car.rentalOptions.outstation.minimumKmChargeable}}km</td></tr>
            <tr><td>Extra Day Rate:</td><td>₹{{$ctrl.car.rentalOptions.outstation.extraDayRate}}/day</td></tr>
            <tr><td>Extra Hour Rate:</td><td>₹{{$ctrl.car.rentalOptions.outstation.extraHourlyRate}}/hour</td></tr>
            <tr><td>Extra KM Rate:</td><td>₹{{$ctrl.car.rentalOptions.outstation.extraKmRate}}/km</td></tr>
        </table>
    </div>
</script>